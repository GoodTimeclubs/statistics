---
title: "Ex03: Probability Theory — Practice Set II (10 Exercises)"
author: "Martin Simon"
output:
  html_document:
    toc: true
    toc_float: true
    number_sections: true
  pdf_document: default
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, fig.width = 7, fig.height = 5, fig.retina = 2)
set.seed(42)
N <- 1e6        # main Monte Carlo sample size (adjust if knitting is slow)
```

## 1) Exercise 2.3.3 — Product of two fair dice (pmf via simulation)

Two fair dice are thrown; let $Y$ be the product. Estimate the pmf of $Y$ by simulation.

```         
nsamples <- 1000
Y <- c()
result <- c()


dice1 <- sample(6,nsamples, replace = TRUE)
dice2 <- sample(6,nsamples, replace = TRUE)
Y <- dice1 * dice2

counts <- table(Y)
totalcount <- length(counts)

pmf_hat <- sort(prop.table(counts))

highest <- tail(pmf_hat,1)
```

## 2) Exercise 2.3.4 — $Z\sim\mathrm{Geometric}(p)$: $\mathbb{P}(5\le Z\le 9)$ via simulation

We adopt the convention $Z\in\{1,2,\dots\}$ (number of trials until the first success). Set $p$ below as needed.

```         
# Parameter
p <- 0.3       # Erfolgswahrscheinlichkeit
n <- 1e6       # Anzahl der Simulationen

# Simulation: Z ~ Geometric(p), mit Werten {1, 2, 3, ...}
# ohne +1L anzahl der Nieten mit +1 Welches Los gewonnen hat nach nieten
Z <- rgeom(n, prob = p) + 1

# Gesuchte Wahrscheinlichkeit: P(5 <= Z <= 9)
prob_est <- mean(Z >= 5 & Z <= 9)
prob_est

#d____ = wahrscheinlich für genau X
#p_____ = <= X
#1-p____ = >= X

#biominialverteilung = mit wiederholung
#hypergometrisch = ohne wiedrholung
```

## 3) Exercise 2.3.5 — $X\sim\mathrm{Binomial}(12,p)$: maximize $\mathbb{P}(X=11)$ via simulation

We scan a grid of $p$ values, estimate $\mathbb{P}(X=11)$ for each by simulation, and report the maximizer.

``` r
#Binominial = zwei outcomes und mit zurücklegen

# wahrscheinlichkeit das wir möglichst oft 11 mal den korb bei 12 würfen treffeb
# p s in vektor in 0.0er schritten
grid <- seq(0,1,0.01)
#Pro p werden nrep Zahlen erstellt
nrep <- 20000

p11_est <- numeric(length(grid))

for (i in seq_along(grid)){ # für alle im Grid
  x <- rbinom (nrep, size = 12, prob = grid[i])
  p11_est[i] <- mean(x == 11)
}

imax <- which.max(p11_est)

data.frame(p_grid = grid[imax], P_Xeq11_est = p11_est[imax])
```

(Optional) You can visualize the estimated curve:

```         
plot(p11_est)
```

## 4) Exercise 2.4.3 — $U\sim\mathrm{Uniform}[0,1]$ probabilities via simulation

```         
 
#Uniform = jede Wahrscheinlichkeit von eienm ereignis ist gleich
#all outcomes are equally likely.

N = 100

U = runif(N)

p1 = mean (U <= 0.5)

p2 = mean (U >= 1/3 & U <= 2/3)

p3 = mean (U == 1)
```

## 5) Exercise 2.4.4 — $Z\sim\mathrm{Exponential}(4)$: tail probabilities via simulation

```         
lambda <- 4

#wahrscheinlichkeit das ereignis in 4 zeitabschnitten stattfindet
p_gt5 = mean (Z>5)

p2to5 = mean(Z>2 & Z <= 5)

#standardfehler des jewailigen schätzers
se_gt5 = sqrt(p_gt5*(1-p_gt5)/N)
se_2to5 = sqrt(p2to5*(1-p_qt5)/N)
```

## 6) Exercise 2.4.5 — Find $c$ so that $f$ is a valid density

We estimate $c$ by enforcing $\int_0^1 f(x)\,dx = 1$ using simulation.

(i) $f(x)=c\,x$ on $(0,1)$.\
(ii) $f(x)=c\,x^n$ on $(0,1)$ for a specified $n>-1$.

```         
#f(x) = x*c = 1
```

## 7) Exercise 2.5.3 — CDF of a scaled die via simulation

Let $X$ be the outcome of a fair die scaled by $1/6$, so $X\in\{1/6,\dots,1\}$. Estimate and plot the empirical cdf.

```         
#CDF ist die wahrscheinlichkeit das ein Wert unter x liegt (<=x)
#Alle wahrscheinlichkeiten darunter addieren
```

We verify cdf properties empirically: nondecreasing (by construction), right-continuous (step ecdf), limits near 0 and 1:

```         
```

## 8) Exercise 2.5.4 — $X\sim\mathcal{N}(0,1)$: probabilities via simulation

```         
```

## 9) Exercise 2.6.2 — Affine transform of a uniform via simulation

If $X\sim \mathrm{Uniform}[L,R]$ and $Y=cX+d$ with $c>0$, verify empirically that $Y$ is uniform on $[cL+d,\,cR+d]$.

```         
```

## 10) Exercise 2.6.3 — Affine transform of a normal via simulation

If $X\sim \mathcal{N}(\mu,\sigma^2)$ and $Y=cX+d$, verify the transformed moments empirically.

```         
#Ergebnis bleibt auch Normalverteilt
```
