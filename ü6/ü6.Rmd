---
title: "ü6"
author: "Ben Gutzeit"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
library(MASS)
library(dplyr)
library(ggplot2)
library(forcats)
data(birthwt)
bwt <- birthwt %>%
mutate(
race = factor(race, levels = c(1,2,3),
labels = c("White","Black","Other")),
smoke = factor(smoke, levels = c(0,1),
labels = c("No","Yes")),
ht = factor(ht, levels = c(0,1),
labels = c("No","Yes")),
ui = factor(ui, levels = c(0,1),
labels = c("No","Yes")),
low = factor(low, levels = c(0,1),
labels = c("No","Yes"))
)
```

# 1.1 In your own words, describe what one row of the object bwt represents

-   **low** = Low birth weight
-   **age** = Mother’s age in years
-   **lwt** = Mother’s weight at last menstrual period (in pounds)
-   **race** = Mother’s race (White, Black, or Other)
-   **smoke** = Whether the mother smoked during pregnancy (Yes/No)
-   **ptl** = Number of previous premature labors
-   **ht** = History of hypertension (Yes/No)
-   **ui** = Presence of uterine irritability (Yes/No)
-   **ftv** = Number of physician visits during the first trimester
-   **bwt** = Baby’s birth weight in grams

# 1.2 Identify which variables are categorical and which are numeric.

```{r categoricalornumeric}

df <- data.frame(
  categorical = c("low","race","smoke","ht","ui"),
  numeric = c("age","lwt","ptl","ftv","bwt")
)

df
```

# 1.3 For each categorical variable, write down the meaning of its levels.

low

-   Yes = low birth weight

-   No = normal birth weight

race

-   White = white skintone

-   Black = black skintone

-   Other = other skintone

smoke

-   Yes = mother is smoker

-   No = mother is no smoker

ht

-   Yes = history of hypertension

-   No = no history of hypertension

ui

-   Yes = uterine irritability

-   No = no uterine irritability

# 2.1 Create a bar chart for and low using ggplot2.

für was und low?

# 2.2 Briefly comment on the proportion of low birth weight (low = "Yes")

```{r ue22}

lyes <- sum(bwt$low == "Yes")
lno <- sum(bwt$low == "No")
lall <- sum(bwt$low != "")

lyes <- lyes / lall
lno <- lno / lall

ldf <- data.frame(
  yes = lyes, 
  no = lno
  )

ldf

#frequency table
table(bwt$low)

```

\~ 31% of the babies are born with underweight

# 3.1 Produce histograms of bwt with three different bin widths, e.g. 100, 250, and 500.

```{r ue31}

hist(bwt$bwt, breaks = 10 , main="Age with breaks = 10")
hist(bwt$bwt, breaks = 25 , main="Age with breaks = 25")
hist(bwt$bwt, breaks = 50 , main="Age with breaks = 50")

ggplot(bwt, aes(x = bwt)) +
  geom_histogram(binwidth = 100) +
  ggtitle("Age with width = 100 and ggplot")
  

ggplot(bwt, aes(x = bwt)) +
  geom_histogram(binwidth = 250)+
  ggtitle("Age with width = 250 and ggplot")

ggplot(bwt, aes(x = bwt)) +
  geom_histogram(binwidth = 500)+
  ggtitle("Age with width = 500 and ggplot")
```

# 3.2 Describe how the choice of bin width changes the appearance of the histogram.

"breaks" changes the widths of the bars

# 3.3 Does the distribution of birth weight appear roughly symmetric, right-skewed, or leftskewed?

```{r ü33}
#ist right skewed laut rule of thumb
(mean(bwt$bwt) < median(bwt$bwt))


#ist left skewed laut rule of thumb
(mean(bwt$bwt) > median(bwt$bwt))
```

-   right skewed

# 4.1 Plot the empirical cumulative distribution function (ECDF) of bwt using stat_ecdf().

The empirical cumulative distribution function (ECDF) shows the proportion of data points less than or equal to each value in a sample.

```{r ue41}

ggplot(bwt, aes(x = bwt)) + stat_ecdf()
plot(ecdf(bwt$bwt))

```

# 4.2 From the ECDF or directly in R, estimate the proportion of babies with birth weight

≤ 2500 g.

```{r u42}
lowbabies <- sum(bwt$bwt <= 2500)

proplowbabies = lowbabies / nrow(bwt)

print(proplowbabies)

#kürzer
mean(bwt$bwt <= 2500)

#oder

p = ecdf(bwt$bwt)
p(2500)
```

\~ 0.3

# 4.3 Estimate the median birth weight visually from the ECDF and compare with the value

from median(bwt\$bwt).

guess: \~3000g

```{r u43}

median(bwt$bwt)

```

#For the birth weight bwt:

# 5.1 Compute the six-number summary (min, Q1, x, ˜ x, Q ¯ 3, max).

The six-number summary is a set of statistics that describes a dataset using the minimum, first quartile (Q1), median, mean, third quartile (Q3), and maximum values.

```{r ü51}

summary(bwt$bwt)

```

# 5.2 Compare the mean and median. What does their relationship suggest about the skewness of the distribution?

Mit skewness ist die Schiefe einer Verteilung gemeint – also ob die Daten symmetrisch verteilt sind oder ob sie nach links oder rechts verzerrt (verschoben) sind.

Mean \< Median =\> left skewed

# For the maternal weight at last menstrual period lwt (in pounds):

# 6.1 Compute the range, interquartile range, and standard deviation of lwt.

-   Range = gesamte Spannweite aller Werte

-   Interquartile Range = Spannweite der mittleren Hälfte der Werte (robuster gegen Ausreißer)

```{r u61}

range <- max(bwt$lwt) - min(bwt$lwt)
print("Range:")
range
InterquartileRange <- (quantile(bwt$lwt, 0.75) - quantile(bwt$lwt, 0.25))
print("Interquartile Range:")
InterquartileRange
standardDeviation <- sd(bwt$lwt)
print("standard Deviation:")
standardDeviation
```

# 6.3

```{r ü63}
boxplot(bwt$lwt)
```

# 7.1

```{r u71}
ggplot(bwt,aes(x = smoke, y = bwt))+
  geom_boxplot()

boxplot(bwt$bwt ~ bwt$smoke)
```

# 7.2

```{r ü71}

bwt %>% group_by(smoke) %>% summarise(median_bwt = median(bwt))

```

#7.3 Compare the IQR in both groups and comment on variability.

```{r ü72}

bwt %>% group_by(smoke) %>% summarise(iqr = IQR(bwt))


```

Das Gewicht variert mehr als bei nichtrauchern als bei rauchern

# 7.4 Do there appear to be more outliers in one group than the other?

There are more outliers for smoker

# 8.1 Produce a density plot of bwt stratified by smoke.

```{r u81}

ggplot(bwt, aes(x = bwt, fill = smoke)) +
  geom_density()

```

# 8.2 Describe how the distributions of birth weight differ between smokers and non-smokers (shape, location, spread).

# 9.1 Produce a so-called violin plot of bwt by smoke.

```{r u91}

ggplot(bwt, aes(x=bwt, y=smoke))+
  geom_violin() +
  

```

# 9.2 Compare the violin plot with the boxplot. What additional information does the violin plot reveal about the shape of the distributions?

```{r u92}

ggplot(bwt, aes(x=bwt, y=smoke))+
  geom_violin() +
  geom_boxplot()

```

It provides a more detiled view of the destribution espachialy above 75% and below 25%

#Consider the relationship between maternal weight lwt and birth weight bwt.

# 10.1 Make a scatterplot of bwt versus lwt.

```{r u101}

plot(bwt$bwt ~ bwt$lwt,
xlab = "LWT",ylab = "BWT")

```

# 10.2 Does higher maternal weight appear to be associated with higher birth weight?

no

# 10.3 Are there any obvious outliers or unusual points?

yes auround the BWT of 3000 are outlies up to 250 LWT

# 11.1 Compute the correlation between lwt and bwt.

```{r u111}

cor(bwt$lwt, bwt$bwt)



```

# 11.2 Interpret the sign and magnitude of the correlation (direction and strength).

Interpretation des Vorzeichens (Direction)

Das Vorzeichen von r zeigt die Richtung des Zusammenhangs:

Vorzeichen Bedeutung r \> 0 positiver Zusammenhang – wenn X steigt, steigt Y tendenziell r \< 0 negativer Zusammenhang – wenn X steigt, sinkt Y tendenziell r = 0 kein linearer Zusammenhang

Der Betrag von r (also \|r\|) zeigt die Stärke des linearen Zusammenhangs:

|             | r            |
|-------------|--------------|
| 0.00 – 0.19 | sehr schwach |
| 0.20 – 0.39 | schwach      |
| 0.40 – 0.59 | mittel       |
| 0.60 – 0.79 | stark        |
| 0.80 – 1.00 | sehr stark   |

Merke: Je näher \|r\| bei 1 liegt, desto stärker ist der lineare Zusammenhang.

Direction = positive Strength = very low

# 11.3 Is your interpretation consistent with the scatterplot from Exercise 10?

yes

# Consider the relationship between smoking status smoke and low birth weight indicator low.

# 12.1 Construct the contingency table table(bwt$smoke, bwt$low).
```{r u121}

tab <- table(bwt$smoke, bwt$low)
rownames(tab) <- c("Non-smoker", "Smoker")
colnames(tab) <- c("Normal weight", "Low weight")
tab


```

# 12.2 Compute row-wise proportions using prop.table(..., margin = 1)
```{r u122}

prtab <- prop.table(table(bwt$smoke, bwt$low), margin = 1)
rownames(prtab) <- c("Non-smoker", "Smoker")
colnames(prtab) <- c("Normal weight", "Low weight")
prtab
```

# 12.3 From the table and proportions, which group (smokers or non-smokers) appears to have a higher proportion of low birth weight?

Smoker

# 13.1 Perform a chi-square test of independence between smoke and low.

p < 0.05 → Zusammenhang wahrscheinlich vorhanden
p ≥ 0.05 → kein nachweisbarer Zusammenhang

```{r u131}

chisq.test(bwt$smoke,bwt$low)

#You interpret a chi-square test by checking whether the p-value is below your significance level to decide if the variables show a statistically significant association.

```


# 13.2 State the null and alternative hypotheses.

Du musst einmal aufschreiben, was „kein Effekt“ bedeutet (H₀) und was „ein Effekt“ bedeutet (H₁).

* **null hypotheses** = smoking is not dependency to low birth weight.
* **alternative hypotheses** = smoking is in dependency to low birth weight.