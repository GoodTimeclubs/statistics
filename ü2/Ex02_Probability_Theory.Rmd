---
title: "Ex02: Probability Theory — Practice Set (10 Exercises)"
author: "Martin Simon"
output:
  html_document:
    toc: true
    toc_float: true
    number_sections: true
  pdf_document: default
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
set.seed(1)
```

# 1) Exercise 1.2.10

Let $\Omega = \{1,2,3\}, P(\{1\})=1/2, P(\{2\})=1/3, P(\{3\})=1/6$. Answer questions (a)-(d) from the lecture notes both with pen and paper and with R.

For the latter you may proceed as follows:

-   Create a list `subs` containing all possible subsets of $\Omega$, each represented as a character vector of element names.

    Bonus: Can you do this automatically?

-   Create a named numeric vector `p` where the names "1", "2", and "3" correspond to elements of the sample space $\Omega$, and their values are their probabilities.

-   Use vector subsetting by name to extract the entries "1" and "2" from `p`, then sum them to obtain `P_12`.

-   Sum all elements of `p` to obtain `P_all`

-   Apply an anonymous function to each element `A` of the list `subs`:

    (i) If `A` is nonempty, it uses vector subsetting `p[A]` to extract the probabilities corresponding to the names in `A`, then computes their sum.

    (ii) If `A` is empty (`length(A)==0`), it returns `0`

    -\> The result `vals` is a numeric vector of event probabilities, one per subset

-   Assign descriptive names to the elements of `vals` for easier reading.

-   As output construct a named list with three components:

    (i) `P_12`: the probability of {1,2}

    (ii) `P_all`: the total probability

    (iii) `events_p_eq_half`: a subset of `vals` selected using logical indexing, keeping only those events where `vals = 0.5` (within numerical tolerance 1e-12).

```         
A0 <- character(0)
A1 <- c(1)
A2 <- c(2)
A3 <- c(3)
A4 <- c(1, 2)
A5 <- c(1, 3)
A6 <- c(2, 3)
A7 <- c(1,2,3)



subs <- list(A0,A1,A2,A3,A4,A5,A6,A7)

p <- c("1" = 1/2, "2" = 1/3, "3" = 1/6)

P_12 = sum(p[c("1","2")])

#→ wählt die Wahrscheinlichkeiten für die Ereignisse {1} und {2} aus.
#Ergibt also c(1/2, 1/3).

P_all <- sum(p)

vals <- c(sapply(subs, function(A) {
  if(length(A)>0){
    return(sum(p[A]))
  }
  if(length(A)==0){
    0
  }
}))

names(vals) <- sapply(subs, function(A) {
  if (length(A) == 0) {
    return("{}")
  } else {
    return(paste0("{", paste(A, collapse = ","), "}"))
  }
})

events_p_eq_half <- vals[(vals - 0.5 > 0 - 1e-12) & (vals - 0.5 < 0 + 1e-12)]

result <- list(
  P_12 = P_12,
  P_all = P_all,
  events_p_eq_half = events_p_eq_half
)

print(result)
```

# 2) Exercise 1.3.2

Answer the question from the lecture notes both exactly with pen and paper and approximately via simulation.

For the latter you may proceed as follows:

-   Set a number `N` of samples you would like to simulate (experiment with different values for `N`)

-   Draw `N` samples `x` uniformly from $\Omega=\{1,2,...,100\}$ so that the components of `x` are independent and identically distributed (i.i.d.) uniform on $\Omega$.

-   Compute an estimate `mean(x%%3==0 \| x%%5==0)`, where `%%` is the modulo operator

-   Compare this to the exact answer obtained via pen and paper

-   As output construct a named numeric vector with the estimate and the exact value

```         
N <- 10

x <- sample(1:100,N)

estimate <- mean(x%%3==0 | x%%5==0)
```

# 3) Example 1.4.6

Answer the question from the lecture notes both exactly with pen and paper and approximately via simulation.

For the latter you may proceed as follows:

-   Set a number `N` of samples you would like to simulate (experiment with different values for `N`)

-   Draw `2N` independent die outcomes (uniform on $\{1,2,...,6\}$)

-   Reshape the resulting vector into an `Nx2` matrix by columns, i.e.,

    -   Column 1 = the first `N` draws

    -   Column 2 = the next `N` draws

    -   Each row now represents one trial with two dice

-   Add the two dice in each row, producing a length-`N` vector `s` of sums.

-   Compute an estimate `mean(s==10)`

-   As output construct a named numeric vector with the estimate and the exact value

```         
N <- sample(10000:15999,1)

o1 <- sample(1:6,N, replace = T)
o2 <- sample(1:6,N, replace = T)

M <- cbind(o1,o2)

s <- rowSums(M)

est <- mean(s==10)

eq10 <- sum(s == 10)

exact <- eq10 / N

result <- c(estimate = est , exact = exact)
result
```

# 4) Exercise 1.4.13

Answer the question from the lecture notes both exactly with pen and paper and in R (no simulation this time).

```         
```

# 5) Challenge 1.4.30

Answer the question (a)-(d) from the lecture notes exactly with pen and paper and answer (d) approximately via simulation.

For the latter you may proceed as follows:

-   Define a function that takes as inputs `C` and the number of samples `N`

-   Simulate `C` birthdays, i.i.d. uniform on $\{1,2,...,365\}$ (no leap days)

-   Use the function `duplicated(v)` which returns a logical vector making entries that repeat a value seen earlier in `v`; the first occurrence is `FALSE`; any repeated occurrence of the same day is `TRUE`

-   Use the `any` function to collapse the aforementioned logical vector to a single `TRUE`/`FALSE`: Is there at least one duplicate?

-   Repeat the whole "Simulate C birthdays and check for a duplicate" experiment `N` times and return a logical vector of length `N`: `TRUE` if the trial had a match.

-   Compute an estimate of $P(\text{some pair matches})$ using the `mean` function

-   Run accross different group sizes and find the 50% crossover

```         
```

# 6) Exercise 1.5.4

Answer the question from the lecture notes both exactly with pen and paper and approximately via simulation.

```         
```

# 7) Example 1.5.1

Answer the following question approximately via simulation: Given that the ball is blue, what is the probability, the urn was urn 2?

```         
```

# 8) Exercise 1.5.13

Answer the question (a)-(e) from the lecture notes exactly with pen and paper and answer (b) and (d) approximately via simulation.

```         
```

# 9) Challenge 1.5.19

Answer the question from the lecture notes exactly with pen and paper and approximately via simulation.

```         
```

# 10) Example 1.5.3

Answer the question "Should the contestant in the Monty Hall Show stay or switch?" approximately via simulation.

```         
```
